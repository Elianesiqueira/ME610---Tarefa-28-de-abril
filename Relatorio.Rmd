---
title: ""
geometry: textwidth=18cm,textheight=21cm
setspace: doublespacing
lang: pt-br
header-includes:
- \usepackage{setspace} #pacote para espaço duplo
- \usepackage{indentfirst} #pacote para identação
- \usepackage[utf8]{inputenc}
- \usepackage{mathptmx}
- \usepackage{enumerate}
- \usepackage{url} #pacote para iserir link
- \usepackage{lipsum}
- \usepackage{multirow} #pacote para mesclar linhas de tabela
output:
  pdf_document:
  html_document: default
  fig_caption: yes
  mainfont: Times New Roman
  
fontsize: 10pt

---

\begin{titlepage}
\begin{center}
\thispagestyle{empty}
\begin{figure}[!htb]
\begin{center}
\begin{minipage}[b]{0.5\linewidth}
\begin{center}
\includegraphics[width=100pt,height=150pt]{logo/logoimeccunicamp.png}
\end{center}
\end{minipage}
\begin{minipage}[b]{0.7\linewidth}
\begin{center}
\vspace*{1cm}
 {\large \bf Universidade Estadual de Campinas\\[5pt]
Instituto de Matemática, Estatística e Computação Cientifica\\[3pt]
Departamento de Estatística}
\end{center}
\end{minipage}
\end{center}
\end{figure}
\vspace*{\stretch{1}}
\begin{center}
\vspace*{5cm}
{\huge \bf Relatório \\[7pt]
Trabalho de ME610}
\end{center}
\vspace*{\stretch{1}}
\begin{center}
\vspace*{4cm}
{\Large \bf Eliane Ramos de Siqueira  RA:155233 \\
Guilherme Pazian  RA:160323 \break
}\\[3pt]
{\large \bf Professor: Maurício Zevallos}\\[5pt]
\end{center}
\vspace*{\stretch{1}}
\centerline{\bf Campinas-SP, 28 de Abril de 2017}
\vspace*{\stretch{1}}
\end{center}
\end{titlepage}

\onehalfspacing
\newpage

```{r, echo=FALSE}
#definindo opções padrões 
knitr::opts_chunk$set(fig.width=6, fig.height=4.5, fig.path='Figs/', fig.align='center', echo=FALSE, warning=FALSE, message=FALSE)
```

```{r pacotes utilizados, echo=FALSE,eval=TRUE, warning=FALSE}
#pacotes utilizados
library(ggplot2)
library(knitr)
library(dplyr)
library(xtable)
```


\begin{enumerate}
\item Introdução
\end{enumerate}
\vspace{0.3cm}
\setlength{\parindent}{3em}

O objetivo deste trabalho é verificar esta opinião através da análise do peso da criança ao nascer

Os dados utilizados foram coletados através de entrevistas com as mães durante a gravidez e correspondem a um ano de estudo. Eles incluem 1236 nascimentos onde a criança sobreviveu pelo menos 28 dias. Além do peso das crianças, foram coletadas informações de outras variáveis que influenciam no peso das crianças.

Para este estudo estamos considerando como variável resposta, o peso da criança ao nascer.

\begin{enumerate}
\setcounter{enumi}{1}
\item Objetivo
\end{enumerate}
\vspace{0.3cm}

Escreva o objetivo aqui

\begin{enumerate}
\setcounter{enumi}{2}
\item Metodologia
\end{enumerate}
\vspace{0.3cm}

Escreva a metodologia aqui

\begin{enumerate}
\setcounter{enumi}{3}
\item Resultados
\end{enumerate}
\vspace{0.3cm}

Escreva os resultados aqui

\begin{enumerate}
\setcounter{enumi}{4}
\item Discussão
\end{enumerate}
\vspace{0.3cm}

Escreva a discussão aqui

\begin{enumerate}
\setcounter{enumi}{4}
\item Anexos
\end{enumerate}
\vspace{0.3cm}

Coloque os anexos aqui

\begin{enumerate}
\setcounter{enumi}{6}
\item Referências
\end{enumerate}
\vspace{0.3cm}

Escreva as referencias aqui

```{r leitura dos dados, echo=FALSE, warning=FALSE}
#setwd(choose.dir())
dados=read.table("dados.txt", header = T)
```

```{r, echo=FALSE, warning=FALSE}
#alterando nomes das variáveis, usando uma tabela feita no excel
descricao<-read.csv("dados.csv", header = T, sep = ";")
descricao<-descricao[,1:2]
names(descricao)<-c("Original", "Nova")

names(dados)<-descricao$Nova #alterando os nomes das variáveis

```

#Limpando os dados

Excluímos as váriaveis: Sexo (apenas masculino), Qtd_feto (apenas 5) e Vivo (apenas 1).

Na variavel Cor_mae, temos uma observação com valor desconhecido (99)  
Na variavel Idade_mae temos duas observações desconhecidas (99)  
Na variavel Educacao_mae temos uma observação desconhecida (9)  
Na variavel Altura_mae temos 22 observações desconhecidas (99)  
Na variavel Peso_mae temos 36 observações desconhecidas (999)  
Na variavel Cor_pai, temos 5 observações com valor desconhecido (99)  
Na variavel Idade_pai, temos 7 observações com valor desconhecido (99)  
Na variavel Educacao_pai, temos 13 observações com valor desconhecido (9)  
Na variavel Altura_pai temos 492 observações desconhecidas (99)  
Na variavel Peso_pai temos 499 observações desconhecidas (999)  
Na variavel Rendimento_anual temos 124 observações desconhecidas (98)  
Na variavel Fuma temos 10 observações desconhecidas (9)  
Na variavel Tempo_sem_fumar temos 9 observações desconhecidas (98) e 1 não perguntado(99)  
Na variavel Numero_cigarros temos 10 observações desconhecidas (98)  

Tiramos as variaveis Peso_pai e Altura_pai devido a quantidade elevada de observações desconhecidas. 

```{r, echo=FALSE, warning=FALSE}
#limpando os dados
dados<-dados[,-17] #excluindo Altura_pai
dados<-dados[,-17] #excluindo Peso_pai

#retirando observações desconhecidas
dados=filter(dados,Rendimento_anual!='98')
dados=filter(dados,Cor_mae!='99')
dados=filter(dados,Idade_mae!='99')
dados=filter(dados,Educacao_mae!='9')
dados=filter(dados,Altura_mae!='99')
dados=filter(dados,Peso_mae!='999')
dados=filter(dados,Cor_pai!='99')
dados=filter(dados,Idade_pai!='99')
dados=filter(dados,Educacao_pai!='9')
dados=filter(dados,Fuma!='9')
dados=filter(dados,Tempo_sem_fumar!='98')
dados=filter(dados,Numero_cigarros!='98')
#retirando observações absurdas para tempo de gestação
dados=filter(dados,Tempo_gestacao<'500')

```

Variáveis disponiveis ainda:  
 
 Data_nasc       
 Tempo_gestacao               
 Peso             
 Cor_mae                 
 Educacao_mae           
 Peso_mae                  
 Peso_pai      
 Altura_pai              
 Estado_civil 2 desconhecidas(0)    
 Fuma              
 Numero_cigarros
 Numero_gestacoes
 Idade_mae 
 Idade_pai 
 Altura_mae
 Cor_pai
 Educacao_pai 
 Rendimento_anual
 Tempo_sem_fumar

#Convertendo unidade de medidas

```{r, echo=FALSE, warning=FALSE}
#convertendo unidade de medidas 
#1 onça equivale à 0,0283 quilos
#Peso da criança

library(dplyr)
dados<-mutate(dados, Peso_kg=Peso*0.0283495)
dados <- mutate(dados,Peso_mae_kg = Peso_mae*0.453592)
dados<- mutate(dados,Altura_mae_cm = Altura_mae*2.54)

```

#Frequencias
```{r, echo=FALSE}
#verificando a frequencia da variavel Fum
freq_fuma=table(dados$Fuma)
names(freq_fuma)<-c("Nunca","Fuma agora","Até a gravidez atual", "Uma vez, não agora")
freq_fuma=as.data.frame(freq_fuma)
names(freq_fuma)<-c("Varíavel Fuma", "Frequência")
kable(freq_fuma)

#library(xtable)
#print(xtable(freq_fuma)) #tabela em latex
```


#Análise Descritiva

Com base na vizualização de análises descritivas (gráficos de dispersão e boxplos), observou-se as relações entre as variáveis explicativas com a variável resposta (peso do bebê ao nascer).Notou-se que existe pouca relação entre as variáveis explicativas "Altura_mae_cm","Idade_pai", "Idade_mae" e "Data_nasc" em relação ao peso do bebê, ou seja, o peso do bebê parece não estar correlacionado com estas variáveis. Portanto optou-se em não incluir estas variáveis explicativas mesmo num modelo inicial. Em relação às demais variáveis explicativas, todas apresentaram indícios de uma possível corelação com o peso dos bebês, de maneira que a distribuição dos dados referêntes à variável resposta muda conforme os valores observados nas variáveis explicativas. Nenhuma variável contínua/discreta aparentou ter uma relação não-linear com o peso dos bebês.


**Grafico de Dispersão**

```{r}
dispersao_peso_pesomae=ggplot(data = dados, aes(x=Peso_mae_kg, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Peso da mãe")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")

dispersao_peso_pesomae
```
MOderado
```{r}
dispersao_peso_Data_nasc=ggplot(data = dados, aes(x=Data_nasc, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Data de nascimento")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")

dispersao_peso_Data_nasc
```

FRACA relaLinear

```{r}
dispersao_peso_Tempo_gestacao=ggplot(data = dados, aes(x=Tempo_gestacao, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Tempo de gestacao")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")

dispersao_peso_Tempo_gestacao
```

FORTE

```{r}
dispersao_peso_Idade_mae=ggplot(data = dados, aes(x=Idade_mae, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Idade da Mãe")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")

dispersao_peso_Idade_mae
```

Pouca relação linear

```{r}
dispersao_peso_Idade_pai=ggplot(data = dados, aes(x=Idade_pai, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Idade do Pai")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")

dispersao_peso_Idade_pai
```

Pouca relação linear
```{r}
dispersao_peso_Altura_mae=ggplot(data = dados, aes(x=Altura_mae_cm, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Altura da Mãe")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")

dispersao_peso_Altura_mae
```
Pouca relação linear


Boxplot para as variaveis categóricas e Dispersão para continua

```{r, echo=FALSE, warning=FALSE}
#bloxplot para peso por cor_mae
library(ggplot2)
boxplot_Cor_mae <- ggplot(data = dados,aes(x=Cor_mae, y=Peso_kg,))+geom_boxplot(aes(group=Cor_mae),outlier.colour = "red")+labs(title="Peso do bebê por Cor da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9,10),labels=c("White(0)","White(1)","White(2)","White(3)","White(4)","White(5)","Mex(6)","Black(7)","Asian(8)","Mixed(9)","?"))
boxplot_Cor_mae
```
INFLUENCIA
```{r, echo=FALSE, warning=FALSE}
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=Educacao_mae, y=Peso_kg))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
```
INFLUENCIA
```{r,echo=FALSE, warning=FALSE}
#boxplot do peso por educacao_pai
boxplot_Educacao_pai <- ggplot(data = dados,aes(x=Educacao_pai, y=Peso_kg))+geom_boxplot(aes(group=Educacao_pai),outlier.colour = "red")+labs(title="Peso do bebê por Educação do pai")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(6)","HS unclear(7)"))
boxplot_Educacao_pai
```
INFLUENCIA
```{r,echo=FALSE, warning=FALSE}
#boxplot do peso por Estado civil
boxplot_Estado_civil <- ggplot(data = dados,aes(x=Estado_civil, y=Peso_kg))+geom_boxplot(aes(group=Estado_civil),outlier.colour = "red")+labs(title="Peso do bebê por Estado civil")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6),labels=c("?","Married","Legally Separated","Divorced","Widowed","Never Married"))
boxplot_Estado_civil
```
INFLUENCIA

```{r,echo=FALSE, warning=FALSE}
#boxplot do peso por Rendimento anual
boxplot_Rendimento_anual <- ggplot(data = dados,aes(x=Rendimento_anual, y=Peso_kg))+geom_boxplot(aes(group=Rendimento_anual),outlier.colour = "red")+labs(title="Peso do bebê por Rendimento Anual")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9),labels=c("<2500","2500-4999","5000-7499","7500-9999","10000-12499","12500-15000",">15000"))
boxplot_Rendimento_anual
```

INFLUÊNCIA****


```{r,echo=FALSE, warning=FALSE}
#boxplot do peso por Fuma
boxplot_Fuma <- ggplot(data = dados,aes(x=Fuma, y=Peso_kg))+geom_boxplot(aes(group=Fuma),outlier.colour = "red")+labs(title="Peso do bebê por Fuma")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3),labels=c("Never","smmokes now","until current pregnancy","once did, not now"))
boxplot_Fuma
```

INFLUENCIA

```{r,echo=FALSE, warning=FALSE}
#boxplot do peso por Tempo_sem_fumar
boxplot_Tempo_sem_fumar <- ggplot(data = dados,aes(x=Tempo_sem_fumar, y=Peso_kg))+geom_boxplot(aes(group=Tempo_sem_fumar),outlier.colour = "red")+labs(title="Peso do bebê por Tempo sem fumar")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9),labels=c("never smoked", "still smokes","during current preg", "within 1 yr", "1 to 2 years ago", "2 to 3 yr ago", "3 to 4 yrs ago", "5 to 9yrs ago", "10+yrs ago", "quit and don't know"))
boxplot_Tempo_sem_fumar
```

INFLUENCIA

```{r,echo=FALSE, warning=FALSE}
#boxplot do peso por Numero_cigarros
boxplot_Numero_cigarros <- ggplot(data = dados,aes(x=Numero_cigarros, y=Peso_kg))+geom_boxplot(aes(group=Numero_cigarros),outlier.colour = "red")+labs(title="Peso do bebê por Numero cigarros")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9),labels=c("never smoked", "still smokes","during current preg", "within 1 yr", "1 to 2 years ago", "2 to 3 yr ago", "3 to 4 yrs ago", "5 to 9yrs ago", "10+yrs ago", "quit and don't know"))
boxplot_Numero_cigarros
```

INFLUENCIA
```{r,echo=FALSE, warning=FALSE}
#boxplot do peso por Numero_gestacoes
boxplot_Numero_gestacoes <- ggplot(data = dados,aes(x=Numero_gestacoes, y=Peso_kg))+geom_boxplot(aes(group=Numero_gestacoes),outlier.colour = "red")+labs(title="Peso do bebê por Numero gestações")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
boxplot_Numero_gestacoes
```


INFLUENCIA


```{r}
#transformando as variáveis categóricas em fator
dados$Cor_mae <- as.factor(dados$Cor_mae)
dados$Educacao_mae <- as.factor(dados$Educacao_mae)
dados$Educacao_pai <- as.factor(dados$Educacao_pai)
dados$Estado_civil <- as.factor(dados$Estado_civil)
dados$Rendimento_anual <- as.factor(dados$Rendimento_anual)
dados$Fuma <- as.factor(dados$Fuma)
dados$Tempo_sem_fumar <- as.factor(dados$Tempo_sem_fumar)
dados$Numero_cigarros <- as.factor(dados$Numero_cigarros)
dados$Numero_gestacoes <- as.factor(dados$Numero_gestacoes)
```


```{r}
fit0 <- lm(Peso_kg~ Numero_gestacoes + Numero_cigarros + Tempo_sem_fumar + Fuma + Rendimento_anual + Estado_civil + Educacao_pai + Educacao_mae + Cor_mae + Peso_mae_kg + Tempo_gestacao,data = dados)

summary(fit0)
```

