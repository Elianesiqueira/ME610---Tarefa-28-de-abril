install.packages("ggplot2")
install.packages("knitr")
install.packages("knitr")
install.packages("dplyr")
install.packages("xtable")
#todos os pacotes utilizados estão aqui
library(ggplot2)
library(knitr)
library(dplyr)
library(xtable)
#setwd(choose.dir())
dados=read.table("dados.txt", header = T)
#alterando nomes das variáveis, usando uma tabela feita no excel
descricao<-read.csv("dados.csv", header = T, sep = ";")
descricao<-descricao[,1:2]
names(descricao)<-c("Original", "Nova")
names(dados)<-descricao$Nova #alterando os nomes das variáveis
#limpando os dados
dados<-dados[,-17] #excluindo Altura_pai
dados<-dados[,-17] #excluindo Peso_pai
#retirando observações desconhecidas
dados=filter(dados,Rendimento_anual!='98')
dados=filter(dados,Cor_mae!='99')
dados=filter(dados,Idade_mae!='99')
dados=filter(dados,Educacao_mae!='9')
dados=filter(dados,Altura_mae!='99')
dados=filter(dados,Peso_mae!='999')
dados=filter(dados,Cor_pai!='99')
dados=filter(dados,Idade_pai!='99')
dados=filter(dados,Educacao_pai!='9')
dados=filter(dados,Fuma!='9')
dados=filter(dados,Tempo_sem_fumar!='98')
dados=filter(dados,Numero_cigarros!='98')
#convertendo unidade de medidas
#1 onça equivale à 0,0283 quilos
#Peso da criança
library(dplyr)
dados<-mutate(dados, Peso_kg=Peso*0.0283)
#verificando a frequencia da variavel Fum
freq_fuma=table(dados$Fuma)
names(freq_fuma)<-c("Nunca","Fuma agora","Até a gravidez atual", "Uma vez, não agora")
freq_fuma=as.data.frame(freq_fuma)
names(freq_fuma)<-c("Varíavel Fuma", "Frequência")
kable(freq_fuma)
#library(xtable)
#print(xtable(freq_fuma)) #tabela em latex
dispersao_peso_pesomae=ggplot(data = dados, aes(x=Peso_mae, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Peso da mãe")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
dispersao_peso_pesomae
View(dados)
View(descricao)
table(dados$Estado_civil)
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=Educacao_mae, y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=Educacao_mae, y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=as.factor(Educacao_mae), y=Peso_kg, fill=as.factor(Educacao_mae)))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=as.factor(Educacao_mae), y=Peso_kg, fill=as.factor(Educacao_mae)))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(1,2,3,4,5,6),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=as.factor(Educacao_mae), y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(1,2,3,4,5,6),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=Educacao_mae, y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(1,2,3,4,5,6),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
table(dados$Educacao_mae)
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=as.factor(Educacao_mae)), y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(1,2,3,4,5,6),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=as.factor(Educacao_mae), y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(1,2,3,4,5,6),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=Educacao_mae, y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(1,2,3,4,5,6),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=Educacao_mae, y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
boxplot(dados$Peso_kg,dados$Educacao_mae[=1])
boxplot(dados$Peso_kg,dados$Educacao_mae[==1])
boxplot(dados$Peso_kg,dados$Educacao_mae)
head(dados$Educacao_mae)
table(dados$Educacao_mae)
summary(dados$Peso_kg)
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=Educacao_mae, y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=Educacao_mae, y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
table(dados$Educacao_mae)
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=as.factor(Educacao_mae), y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=as.factor(Educacao_mae), y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(1,2,3,4,5,6),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=as.factor(Educacao_mae), y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(1,2,3,4,5,6,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=as.factor(Educacao_mae), y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=as.factor(Educacao_mae), y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=as.factor(Educacao_mae), y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=as.factor(Educacao_mae), y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=as.factor(Educacao_mae), y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(1,2,3,4,5,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=as.factor(Educacao_mae), y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=Educacao_mae, y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
install.packages("knitr")
install.packages("knitr")
install.packages("xtable")
#todos os pacotes utilizados estão aqui
library(ggplot2)
library(knitr)
library(dplyr)
library(xtable)
#setwd(choose.dir())
dados=read.table("dados.txt", header = T)
#alterando nomes das variáveis, usando uma tabela feita no excel
descricao<-read.csv("dados.csv", header = T, sep = ";")
descricao<-descricao[,1:2]
names(descricao)<-c("Original", "Nova")
names(dados)<-descricao$Nova #alterando os nomes das variáveis
#limpando os dados
dados<-dados[,-17] #excluindo Altura_pai
dados<-dados[,-17] #excluindo Peso_pai
#retirando observações desconhecidas
dados=filter(dados,Rendimento_anual!='98')
dados=filter(dados,Cor_mae!='99')
dados=filter(dados,Idade_mae!='99')
dados=filter(dados,Educacao_mae!='9')
dados=filter(dados,Altura_mae!='99')
dados=filter(dados,Peso_mae!='999')
dados=filter(dados,Cor_pai!='99')
dados=filter(dados,Idade_pai!='99')
dados=filter(dados,Educacao_pai!='9')
dados=filter(dados,Fuma!='9')
dados=filter(dados,Tempo_sem_fumar!='98')
dados=filter(dados,Numero_cigarros!='98')
#convertendo unidade de medidas
#1 onça equivale à 0,0283 quilos
#Peso da criança
library(dplyr)
dados<-mutate(dados, Peso_kg=Peso*0.0283495)
dados <- mutate(dados,Peso_mae_kg = Peso_mae*0.453592)
dados<- mutate(dados,Altura_mae_cm = Altura_mae*2.54)
#verificando a frequencia da variavel Fum
freq_fuma=table(dados$Fuma)
names(freq_fuma)<-c("Nunca","Fuma agora","Até a gravidez atual", "Uma vez, não agora")
freq_fuma=as.data.frame(freq_fuma)
names(freq_fuma)<-c("Varíavel Fuma", "Frequência")
kable(freq_fuma)
#library(xtable)
#print(xtable(freq_fuma)) #tabela em latex
dispersao_peso_pesomae=ggplot(data = dados, aes(x=Peso_mae_kg, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Peso da mãe")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
dispersao_peso_pesomae
#bloxplot para peso por cor_mae
library(ggplot2)
boxplot_Cor_mae <- ggplot(data = dados,aes(x=Cor_mae, y=Peso_kg, fill=Cor_mae))+geom_boxplot(aes(group=Cor_mae),outlier.colour = "red")+labs(title="Peso do bebê por Cor da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9,10),labels=c("White(0)","White(1)","White(2)","White(3)","White(4)","White(5)","Mex(6)","Black(7)","Asian(8)","Mixed(9)","?"))
boxplot_Cor_mae
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=Educacao_mae, y=Peso_kg, fill=Educacao_mae))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_pai
boxplot_Educacao_pai <- ggplot(data = dados,aes(x=Educacao_pai, y=Peso_kg, fill=Educacao_pai))+geom_boxplot(aes(group=Educacao_pai),outlier.colour = "red")+labs(title="Peso do bebê por Educação do pai")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(6)","HS unclear(7)"))
boxplot_Educacao_pai
#boxplot do peso por educacao_pai
boxplot_Estado_civil <- ggplot(data = dados,aes(x=Estado_civil, y=Peso_kg, fill=Estado_civil))+geom_boxplot(aes(group=Estado_civil),outlier.colour = "red")+labs(title="Peso do bebê por Estado civil")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6),labels=c("?","Married","Legally Separated","Divorced","Widowed","Never Married"))
boxplot_Estado_civil
View(descricao)
#boxplot do peso por
boxplot_Rendimento_anual <- ggplot(data = dados,aes(x=Rendimento_anual, y=Peso_kg, fill=Rendimento_anual))+geom_boxplot(aes(group=Rendimento_anual),outlier.colour = "red")+labs(title="Peso do bebê por Estado civil")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6),labels=c("<$2500","$2500-$4999","5000-7499","7500-9999","10000-12499","12500-15000",">15000"))
boxplot_Rendimento_anual
#boxplot do peso por
boxplot_Rendimento_anual <- ggplot(data = dados,aes(x=Rendimento_anual, y=Peso_kg, fill=Rendimento_anual))+geom_boxplot(aes(group=Rendimento_anual),outlier.colour = "red")+labs(title="Peso do bebê por Estado civil")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8),labels=c("<$2500","$2500-$4999","5000-7499","7500-9999","10000-12499","12500-15000",">15000"))
boxplot_Rendimento_anual
#boxplot do peso por
boxplot_Rendimento_anual <- ggplot(data = dados,aes(x=Rendimento_anual, y=Peso_kg, fill=Rendimento_anual))+geom_boxplot(aes(group=Rendimento_anual),outlier.colour = "red")+labs(title="Peso do bebê por Estado civil")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9),labels=c("<$2500","$2500-$4999","5000-7499","7500-9999","10000-12499","12500-15000",">15000"))
boxplot_Rendimento_anual
#boxplot do peso por
boxplot_Rendimento_anual <- ggplot(data = dados,aes(x=Rendimento_anual, y=Peso_kg, fill=Rendimento_anual))+geom_boxplot(aes(group=Rendimento_anual),outlier.colour = "red")+labs(title="Peso do bebê por Estado civil")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9,10),labels=c("<2500","2500-4999","5000-7499","7500-9999","10000-12499","12500-15000",">15000"))
boxplot_Rendimento_anual
#boxplot do peso por
boxplot_Rendimento_anual <- ggplot(data = dados,aes(x=Rendimento_anual, y=Peso_kg, fill=Rendimento_anual))+geom_boxplot(aes(group=Rendimento_anual),outlier.colour = "red")+labs(title="Peso do bebê por Rendimento Anual")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9,10),labels=c("<2500","2500-4999","5000-7499","7500-9999","10000-12499","12500-15000",">15000"))
boxplot_Rendimento_anual
#bloxplot para peso por cor_mae
library(ggplot2)
boxplot_Cor_mae <- ggplot(data = dados,aes(x=Cor_mae, y=Peso_kg))+geom_boxplot(aes(group=Cor_mae),outlier.colour = "red")+labs(title="Peso do bebê por Cor da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5)) + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9,10),labels=c("White(0)","White(1)","White(2)","White(3)","White(4)","White(5)","Mex(6)","Black(7)","Asian(8)","Mixed(9)","?"))
boxplot_Cor_mae
factor_Rendimento_anual <- as.factor(Rendimento_anual)
factor_Rendimento_anual <- as.factor(dados$Rendimento_anual)
levels(dados$Rendimento_anual)
levels(factor_Rendimento_anual)
a<-levels(dados$Rendimento_anual)
factor_Rendimento_anual <- as.factor(dados$Rendimento_anual,levels=a,labels("a","b"))
#boxplot do peso por educacao_mae
boxplot_Educacao_mae <- ggplot(data = dados,aes(x=Educacao_mae, y=Peso_kg))+geom_boxplot(aes(group=as.factor(Educacao_mae)),outlier.colour = "red")+labs(title="Peso do bebê por Educação da mãe")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(7)"))
boxplot_Educacao_mae
#boxplot do peso por educacao_pai
boxplot_Educacao_pai <- ggplot(data = dados,aes(x=Educacao_pai, y=Peso_kg))+geom_boxplot(aes(group=Educacao_pai),outlier.colour = "red")+labs(title="Peso do bebê por Educação do pai")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7),labels=c("<8th","8th -12th","HS","HS+trade","HS+college","College","HS unclear(6)","HS unclear(7)"))
boxplot_Educacao_pai
#boxplot do peso por Estado civil
boxplot_Estado_civil <- ggplot(data = dados,aes(x=Estado_civil, y=Peso_kg))+geom_boxplot(aes(group=Estado_civil),outlier.colour = "red")+labs(title="Peso do bebê por Estado civil")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6),labels=c("?","Married","Legally Separated","Divorced","Widowed","Never Married"))
boxplot_Estado_civil
#boxplot do peso por
boxplot_Rendimento_anual <- ggplot(data = dados,aes(x=Rendimento_anual, y=Peso_kg))+geom_boxplot(aes(group=Rendimento_anual),outlier.colour = "red")+labs(title="Peso do bebê por Rendimento Anual")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9,10),labels=c("<2500","2500-4999","5000-7499","7500-9999","10000-12499","12500-15000",">15000"))
boxplot_Rendimento_anual
#boxplot do peso por Fuma
boxplot_Fuma <- ggplot(data = dados,aes(x=Fuma, y=Peso_kg))+geom_boxplot(aes(group=Fuma),outlier.colour = "red")+labs(title="Peso do bebê por Rendimento Anual")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9,10),labels=c("<2500","2500-4999","5000-7499","7500-9999","10000-12499","12500-15000",">15000"))
boxplot_Fuma
#boxplot do peso por Fuma
boxplot_Fuma <- ggplot(data = dados,aes(x=Fuma, y=Peso_kg))+geom_boxplot(aes(group=Fuma),outlier.colour = "red")+labs(title="Peso do bebê por Rendimento Anual")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3),labels=c("Never","until current pregnancy","once did, not now"))
boxplot_Fuma
table(dados$Fuma)
#boxplot do peso por Fuma
boxplot_Fuma <- ggplot(data = dados,aes(x=Fuma, y=Peso_kg))+geom_boxplot(aes(group=Fuma),outlier.colour = "red")+labs(title="Peso do bebê por Rendimento Anual")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3),labels=c("Never","smmokes now","until current pregnancy","once did, not now"))
boxplot_Fuma
#boxplot do peso por Tempo_sem_fumar
boxplot_Tempo_sem_fumar <- ggplot(data = dados,aes(x=Tempo_sem_fumar, y=Peso_kg))+geom_boxplot(aes(group=Tempo_sem_fumar),outlier.colour = "red")+labs(title="Peso do bebê por Rendimento Anual")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3),labels=c("never smoked", "still smokes","during current preg", "within 1 yr", "1 to 2 years ago", "2 to 3 yr ago", "3 to 4 yrs ago", "5 to 9yrs ago", "10+yrs ago", "quit and don't know"))
boxplot_Tempo_sem_fumar
#boxplot do peso por Tempo_sem_fumar
boxplot_Tempo_sem_fumar <- ggplot(data = dados,aes(x=Tempo_sem_fumar, y=Peso_kg))+geom_boxplot(aes(group=Tempo_sem_fumar),outlier.colour = "red")+labs(title="Peso do bebê por Rendimento Anual")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9),labels=c("never smoked", "still smokes","during current preg", "within 1 yr", "1 to 2 years ago", "2 to 3 yr ago", "3 to 4 yrs ago", "5 to 9yrs ago", "10+yrs ago", "quit and don't know"))
boxplot_Tempo_sem_fumar
#boxplot do peso por Fuma
boxplot_Fuma <- ggplot(data = dados,aes(x=Fuma, y=Peso_kg))+geom_boxplot(aes(group=Fuma),outlier.colour = "red")+labs(title="Peso do bebê por Rendimento Anual")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3),labels=c("Never","smmokes now","until current pregnancy","once did, not now"))
boxplot_Fuma
#boxplot do peso por Rendimento anual
boxplot_Rendimento_anual <- ggplot(data = dados,aes(x=Rendimento_anual, y=Peso_kg))+geom_boxplot(aes(group=Rendimento_anual),outlier.colour = "red")+labs(title="Peso do bebê por Rendimento Anual")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9,10),labels=c("<2500","2500-4999","5000-7499","7500-9999","10000-12499","12500-15000",">15000"))
boxplot_Rendimento_anual
#boxplot do peso por Rendimento anual
boxplot_Rendimento_anual <- ggplot(data = dados,aes(x=Rendimento_anual, y=Peso_kg))+geom_boxplot(aes(group=Rendimento_anual),outlier.colour = "red")+labs(title="Peso do bebê por Rendimento Anual")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9),labels=c("<2500","2500-4999","5000-7499","7500-9999","10000-12499","12500-15000",">15000"))
boxplot_Rendimento_anual
#boxplot do peso por Numero_cigarros
boxplot_Numero_cigarros <- ggplot(data = dados,aes(x=Numero_cigarros, y=Peso_kg))+geom_boxplot(aes(group=Numero_cigarros),outlier.colour = "red")+labs(title="Peso do bebê por Tempo sem fumar")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9),labels=c("never smoked", "still smokes","during current preg", "within 1 yr", "1 to 2 years ago", "2 to 3 yr ago", "3 to 4 yrs ago", "5 to 9yrs ago", "10+yrs ago", "quit and don't know"))
boxplot_Numero_cigarros
#boxplot do peso por Numero_cigarros
boxplot_Numero_cigarros <- ggplot(data = dados,aes(x=Numero_cigarros, y=Peso_kg))+geom_boxplot(aes(group=Numero_cigarros),outlier.colour = "red")+labs(title="Peso do bebê por Numero cigarros")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9),labels=c("never smoked", "still smokes","during current preg", "within 1 yr", "1 to 2 years ago", "2 to 3 yr ago", "3 to 4 yrs ago", "5 to 9yrs ago", "10+yrs ago", "quit and don't know"))
boxplot_Numero_cigarros
dispersao_peso_Data_nasc=ggplot(data = dados, aes(x=Data_nasc, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Data de nascimento")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
dispersao_peso_Data_nasc
dispersao_peso_Tempo_gestacao=ggplot(data = dados, aes(x=Tempo_gestacao, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Tempo de gestacao")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
dispersao_peso_Tempo_gestacao
#setwd(choose.dir())
dados=read.table("dados.txt", header = T)
#alterando nomes das variáveis, usando uma tabela feita no excel
descricao<-read.csv("dados.csv", header = T, sep = ";")
descricao<-descricao[,1:2]
names(descricao)<-c("Original", "Nova")
names(dados)<-descricao$Nova #alterando os nomes das variáveis
#limpando os dados
dados<-dados[,-17] #excluindo Altura_pai
dados<-dados[,-17] #excluindo Peso_pai
#retirando observações desconhecidas
dados=filter(dados,Rendimento_anual!='98')
dados=filter(dados,Cor_mae!='99')
dados=filter(dados,Idade_mae!='99')
dados=filter(dados,Educacao_mae!='9')
dados=filter(dados,Altura_mae!='99')
dados=filter(dados,Peso_mae!='999')
dados=filter(dados,Cor_pai!='99')
dados=filter(dados,Idade_pai!='99')
dados=filter(dados,Educacao_pai!='9')
dados=filter(dados,Fuma!='9')
dados=filter(dados,Tempo_sem_fumar!='98')
dados=filter(dados,Numero_cigarros!='98')
#retirando observações absurdas para tempo de gestação
dados=filter(dados,Tempo_gestacao<'500')
#convertendo unidade de medidas
#1 onça equivale à 0,0283 quilos
#Peso da criança
library(dplyr)
dados<-mutate(dados, Peso_kg=Peso*0.0283495)
dados <- mutate(dados,Peso_mae_kg = Peso_mae*0.453592)
dados<- mutate(dados,Altura_mae_cm = Altura_mae*2.54)
#verificando a frequencia da variavel Fum
freq_fuma=table(dados$Fuma)
names(freq_fuma)<-c("Nunca","Fuma agora","Até a gravidez atual", "Uma vez, não agora")
freq_fuma=as.data.frame(freq_fuma)
names(freq_fuma)<-c("Varíavel Fuma", "Frequência")
kable(freq_fuma)
#library(xtable)
#print(xtable(freq_fuma)) #tabela em latex
dispersao_peso_pesomae=ggplot(data = dados, aes(x=Data_nasc, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Peso da mãe")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
dispersao_peso_pesomae
dispersao_peso_Data_nasc=ggplot(data = dados, aes(x=Data_nasc, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Data de nascimento")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
dispersao_peso_Data_nasc
dispersao_peso_Tempo_gestacao=ggplot(data = dados, aes(x=Tempo_gestacao, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Tempo de gestacao")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
dispersao_peso_Tempo_gestacao
150/7
21/4
dispersao_peso_Numero_gestacoes=ggplot(data = dados, aes(x=Numero_gestacoes, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Numero de gestações")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
dispersao_peso_Numero_gestacao
dispersao_peso_Numero_gestacoes=ggplot(data = dados, aes(x=Numero_gestacoes, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Numero de gestações")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
dispersao_peso_Numero_gestacoes
dispersao_peso_Idade_mae=ggplot(data = dados, aes(x=Idade_mae, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Idade da Mãe")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
dispersao_peso_Numero_gestacoes
dispersao_peso_Idade_mae=ggplot(data = dados, aes(x=Idade_mae, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Idade da Mãe")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
dispersao_peso_Idade_mae
dispersao_peso_Idade_pai=ggplot(data = dados, aes(x=Idade_pai, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Idade do Pai")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
dispersao_peso_Idade_pai
dispersao_peso_Altura_mae=ggplot(data = dados, aes(x=Idade_pai, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Altura da Mãe")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
dispersao_peso_Altura_mae
#boxplot do peso por Numero_gestacoes
boxplot_Numero_gestacoes <- ggplot(data = dados,aes(x=Numero_gestacoes, y=Peso_kg))+geom_boxplot(aes(group=Numero_gestacoes),outlier.colour = "red")+labs(title="Peso do bebê por Numero cigarros")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
boxplot_Numero_cigarros
#boxplot do peso por Numero_gestacoes
boxplot_Numero_gestacoes <- ggplot(data = dados,aes(x=Numero_gestacoes, y=Peso_kg))+geom_boxplot(aes(group=Numero_gestacoes),outlier.colour = "red")+labs(title="Peso do bebê por Numero cigarros")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
boxplot_Numero_gestacoes
#boxplot do peso por Numero_gestacoes
boxplot_Numero_gestacoes <- ggplot(data = dados,aes(x=Numero_gestacoes, y=Peso_kg))+geom_boxplot(aes(group=Numero_gestacoes),outlier.colour = "red")+labs(title="Peso do bebê por Numero cigarros")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + break(1,2,3)
#boxplot do peso por Numero_gestacoes
boxplot_Numero_gestacoes <- ggplot(data = dados,aes(x=Numero_gestacoes, y=Peso_kg))+geom_boxplot(aes(group=Numero_gestacoes),outlier.colour = "red")+labs(title="Peso do bebê por Numero cigarros")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits=seq(1:12))
boxplot_Numero_gestacoes
#boxplot do peso por Numero_gestacoes
boxplot_Numero_gestacoes <- ggplot(data = dados,aes(x=Numero_gestacoes, y=Peso_kg))+geom_boxplot(aes(group=Numero_gestacoes),outlier.colour = "red")+labs(title="Peso do bebê por Numero cigarros")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits=seq(1:15))
boxplot_Numero_gestacoes
#boxplot do peso por Numero_gestacoes
boxplot_Numero_gestacoes <- ggplot(data = dados,aes(x=Numero_gestacoes, y=Peso_kg))+geom_boxplot(aes(group=Numero_gestacoes),outlier.colour = "red")+labs(title="Peso do bebê por Numero cigarros")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
boxplot_Numero_gestacoes
View(dados)
dispersao_peso_pesomae=ggplot(data = dados, aes(x=Peso_mae_kg, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Peso da mãe")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
dispersao_peso_pesomae
dispersao_peso_Altura_mae=ggplot(data = dados, aes(x=Altura_mae_kg, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Altura da Mãe")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
dispersao_peso_Altura_mae
dispersao_peso_Altura_mae=ggplot(data = dados, aes(x=Altura_mae_cm, y=Peso_kg))+geom_point()+labs(title="Peso do bebê por Altura da Mãe")+theme_bw()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
dispersao_peso_Altura_mae
#boxplot do peso por Numero_cigarros
boxplot_Numero_cigarros <- ggplot(data = dados,aes(x=Numero_cigarros, y=Peso_kg))+geom_boxplot(aes(group=Numero_cigarros),outlier.colour = "red")+labs(title="Peso do bebê por Numero cigarros")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9),labels=c("never smoked", "still smokes","during current preg", "within 1 yr", "1 to 2 years ago", "2 to 3 yr ago", "3 to 4 yrs ago", "5 to 9yrs ago", "10+yrs ago", "quit and don't know"))
boxplot_Numero_cigarros
#boxplot do peso por Numero_gestacoes
boxplot_Numero_gestacoes <- ggplot(data = dados,aes(x=Numero_gestacoes, y=Peso_kg))+geom_boxplot(aes(group=Numero_gestacoes),outlier.colour = "red")+labs(title="Peso do bebê por Numero gestações")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none")
boxplot_Numero_gestacoes
#boxplot do peso por Numero_cigarros
boxplot_Numero_cigarros <- ggplot(data = dados,aes(x=Numero_cigarros, y=Peso_kg))+geom_boxplot(aes(group=Numero_cigarros),outlier.colour = "red")+labs(title="Peso do bebê por Numero cigarros")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9),labels=c("never smoked", "still smokes","during current preg", "within 1 yr", "1 to 2 years ago", "2 to 3 yr ago", "3 to 4 yrs ago", "5 to 9yrs ago", "10+yrs ago", "quit and don't know"))
boxplot_Numero_cigarros
#boxplot do peso por Tempo_sem_fumar
boxplot_Tempo_sem_fumar <- ggplot(data = dados,aes(x=Tempo_sem_fumar, y=Peso_kg))+geom_boxplot(aes(group=Tempo_sem_fumar),outlier.colour = "red")+labs(title="Peso do bebê por Tempo sem fumar")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9),labels=c("never smoked", "still smokes","during current preg", "within 1 yr", "1 to 2 years ago", "2 to 3 yr ago", "3 to 4 yrs ago", "5 to 9yrs ago", "10+yrs ago", "quit and don't know"))
boxplot_Tempo_sem_fumar
#boxplot do peso por Fuma
boxplot_Fuma <- ggplot(data = dados,aes(x=Fuma, y=Peso_kg))+geom_boxplot(aes(group=Fuma),outlier.colour = "red")+labs(title="Peso do bebê por Fuma")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3),labels=c("Never","smmokes now","until current pregnancy","once did, not now"))
boxplot_Fuma
#boxplot do peso por Tempo_sem_fumar
boxplot_Tempo_sem_fumar <- ggplot(data = dados,aes(x=Tempo_sem_fumar, y=Peso_kg))+geom_boxplot(aes(group=Tempo_sem_fumar),outlier.colour = "red")+labs(title="Peso do bebê por Tempo sem fumar")+theme_classic()+theme(plot.title = element_text(hjust = 0.5),legend.position = "none") + scale_x_discrete(limits= c(0,1,2,3,4,5,6,7,8,9),labels=c("never smoked", "still smokes","during current preg", "within 1 yr", "1 to 2 years ago", "2 to 3 yr ago", "3 to 4 yrs ago", "5 to 9yrs ago", "10+yrs ago", "quit and don't know"))
boxplot_Tempo_sem_fumar
fit0 <- lm(Peso_kg~ Numero_gestacoes + Numero_cigarros + Tempo_sem_fumar + Fuma + Rendimento_anual + Estado_civil + Educacao_pai + Educacao_mae + Cor_mae + Peso_mae_kg + Tempo_gestacao,data = dados)
summary(fit0)
#transformando as variáveis categóricas em fator
dados$Cor_mae <- as.factor(dados$Cor_mae)
dados$Educacao_mae <- as.factor(dados$Educacao_mae)
dados$Educacao_pai <- as.factor(dados$Educacao_pai)
dados$Estado_civil <- as.factor(dados$Estado_civil)
dados$Rendimento_anual <- as.factor(dados$Rendimento_anual)
dados$Fuma <- as.factor(dados$Fuma)
dados$Tempo_sem_fumar <- as.factor(dados$Tempo_sem_fumar)
dados$Numero_cigarros <- as.factor(dados$Numero_cigarros)
dados$Numero_gestacoes <- as.factor(dados$Numero_gestacoes)
fit0 <- lm(Peso_kg~ Numero_gestacoes + Numero_cigarros + Tempo_sem_fumar + Fuma + Rendimento_anual + Estado_civil + Educacao_pai + Educacao_mae + Cor_mae + Peso_mae_kg + Tempo_gestacao,data = dados)
summary(fit0)
install.packages(""installr"")
install.packages("installr")
